<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Amplicon analysis with long reads - SABio v1</title>
  <style>
    :root {
      --primary: #0066ff;
      --primary-light: #617dff;
      --accent: #00d1b2;
      --background: #f4f6f9;
      --card-bg: #ffffffee;
      --text-color: #1e1e2f;
      --shadow: 0 12px 30px rgba(0,0,0,0.1);
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #eef2f3, #f5f7fa);
      margin: 0;
      color: var(--text-color);
      scroll-behavior: smooth;
    }

    h1, h2 {
      font-weight: 700;
      text-align: center;
    }

    h1 {
      font-size: 2.8rem;
      margin: 40px 0 20px;
      color: var(--primary);
    }

    h2 {
      color: var(--accent);
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    .buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
    }

    .buttons a {
      background-color: var(--primary);
      color: white;
      text-decoration: none;
      font-weight: 600;
      padding: 12px 24px;
      margin: 5px;
      border-radius: 30px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
      width: 80%;
      max-width: 300px;
      text-align: center;
      position: relative;
      z-index: 2;
    }

    .buttons a:hover {
      background-color: #0047b3;
      transform: translateY(-2px);
    }

    .arrow {
      font-size: 20px;
      color: var(--primary);
      margin: 5px 0;
    }

    .substeps {
      display: flex;
      gap: 20px;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 10px;
      width: 100%;
    }

    .substeps a {
      background-color: var(--primary-light); /* color más claro para subpasos */
      color: white;
      text-decoration: none;
      font-weight: 600;
      padding: 12px 24px;
      border-radius: 30px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
      text-align: center;
      display: inline-block;
      min-width: 250px;
      z-index: 2;
    }

    .substeps a:hover {
      background-color: #1a75d1;
      transform: translateY(-2px);
    }
    .arrow {
      font-size: 20px;
      color: var(--primary);
    }

    .content {
      background: var(--card-bg);
      margin: 40px auto;
      padding: 30px;
      border-radius: 20px;
      max-width: 1000px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      transition: all 0.4s ease;
    }

    .content p {
      line-height: 1.7;
      font-size: 1.05rem;
    }

    .content ul {
      margin-top: 0;
      padding-left: 20px;
    }

    .images {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 10px;
      margin-top: 15px;
    }

    .images img {
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      height: auto;
    }

    a.report-link {
      display: inline-block;
      text-align: center;
      margin: 20px auto;
      font-weight: bold;
      color: var(--primary);
      text-decoration: underline;
    }
    
    .images-with-arrow {
     display: flex;
     align-items: center;
     justify-content: center;
     gap: 10px; /* Espacio entre imágenes y flecha */
   }

   .images-with-arrow .image {
    width: 45%;
    max-width: 400px;
   }

   .arrow {
    font-size: 2rem; /* Tamaño de la flecha */
    margin: 0 10px;
   }    
  </style>
</head>
<body>

  <h1>Amplicon analysis with long reads offered by SABio</h1>
  <div class="buttons">
    <a href="#fase1">Step 1: Data quality control</a>
    <div class="arrow">↓</div>

    <a href="#fase2">Step 2: Trimming</a>
    <div class="arrow">↓</div>

    <a href="#fase3">Step 3: Denoising/Clustering</a>
    <div class="arrow">↓</div>

    <a href="#fase4">Step 4: Taxonomic assignment and visualization</a>
    <div class="arrow">↓</div>

    <a href="#fase5">Step 5: Abundance profiling</a>
  </div>

  <div class="content" id="fase1">
    <h2>Step 1: Data Quality Control</h2>
    <p>Raw sequencing data (FASTQ files) is assessed for quality using long-read specific tools from NanoQC package. This step detects issues such as adapter contamination, low-quality reads, or GC bias before continuing with further analysis.</p>
    <div class="images">
      <img src="1-NanoQC.png" alt="Quality control" style="width: 45%;">
      <img src="1-NanoPlot_scatter.png" alt="Quality control bad" style="width: 45%;">
    </div>
  </div>

  <div class="content" id="fase2">
    <h2>Step 2: Trimming</h2>
    <p>Reads are trimmed according to different parameters. Adapters are removed, and then reads are filtered by quality (considering if sequences were originated with PacBio or ONT technology) and length (to minimum-maximum amplicon size).</p>
    <div class="images-with-arrow">
      <img src="2-pretrim_NanoPlot_scatter_dot.png" alt="Before Trimming" class="image" style="width: 40%;">
      <div class="arrow">⟶</div>
      <img src="2-posttrim_NanoPlot_scatter_dot.png" alt="After Trimming" class="image" style="width: 40%">
    </div>  
  </div>
    
  <div class="content" id="fase3">
    <h2>Step 3: Denoising/Clustering</h2>
    <p>Long read amplicon unsupervised clustering is performed with NanoCLUST software. Based on sequence similarity and followed by consensus sequence generation for each cluster, this step is crucial to reduce sequencing errors that will allow for accurate taxonomic classification. It reduces Nanopore's error rate and produces representative and high-confidence sequences per taxon.</p>
    <div class="images">
      <img src="3-NanoCLUST_clustering.png" alt="clustering" style="width: 500px;">
    </div>
  </div>

  <div class="content" id="fase4">
    <h2>Step 4: Taxonomic assignment and visualization </h2>
    <p>A wide set of tools can be used to perform the taxonomic assignment of reads/OTUs/consensus sequences, depending on the target amplicon. Centrifuge, Kraken2 or BLASTn, using as reference different databases, can stablish the different taxa that the sample comprises. Output is often a table that includes each read/OTU/sequence, taxonomical assignation, % identity and a score/value indicating the strength of the assignation. </p>
    <div class="images">
      <img src="4-Centrifuge1.png" alt="clustering" style="width: 85%;">
      <img src="4-Centrifuge2.png" alt="clustering" style="width: 85%;">
    </div>

    <p>This taxonomic assignment can be then graphically visualized with Krona, which generates a multilayer interactive piechart with a hierarchical representation of taxa.</p>
    <div class="images">
      <img src="4-Krona_snapshot.svg" alt="krona_static" style="width: 100%;">
    </div>
    <p style="text-align: center;">
      <a class="report-link" href="5-krona/SRR10391201.krona.html" target="_blank">
        ➤ View interactive Krona chart
      </a>
    </p>
  </div>

  <div class="content" id="fase5">
    <h2>Step 5: Abundance profiling</h2>
    <p>The relative content of each taxa can be calculated and graphically represented within a sample. Several tools provide these plots, like NanoCLUST (previously used for denoising/clustering) or EMU.</p>
    <div class="images">
      <img src="5-NanoCLUST_rel_abundance_by-gen.png" alt="abundance" style="width: 40%;">
      <img src="5-EMU_Rel-abundance_by-species.png" alt="abundance" style="width: 40%;">            
    </div>
  </div>

</body>
</html>
