<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SABio - Metagenomics</title>
  <style>
    :root {
      --primary: #0066ff;
      --accent: #00d1b2;
      --background: #f4f6f9;
      --card-bg: #ffffffee;
      --text-color: #1e1e2f;
      --shadow: 0 12px 30px rgba(0,0,0,0.1);
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #eef2f3, #f5f7fa);
      margin: 0;
      color: var(--text-color);
      scroll-behavior: smooth;
      text-align: justify;
    }

    h1, h2 {
      font-weight: 700;
      text-align: center;
    }

    h1 {
      font-size: 2.8rem;
      margin: 40px 0 20px;
      color: var(--primary);
    }

    h2 {
      color: var(--accent);
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    ul li {
      margin-bottom: 15px; /* Espacio extra entre elementos */
    }

    .buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
    }

    .buttons a {
      background-color: var(--primary);
      color: white;
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
      padding: 12px 24px;
      margin: 5px;
      border-radius: 30px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
      width: 80%;
      max-width: 350px;
      text-align: center;
    }

    .buttons a:hover {
      background-color: #0047b3;
      transform: translateY(-2px);
    }

    .arrow {
      font-size: 20px;
      color: var(--primary);
    }

    .content {
      background: var(--card-bg);
      margin: 40px auto;
      padding: 30px;
      border-radius: 20px;
      max-width: 1000px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      transition: all 0.4s ease;
    }

    .content p {
      line-height: 1.5;
      font-size: 1.05rem;
    }

    .content ul {
      margin-top: 0;
      padding-left: 20px;
      line-height: 1.5;
    }

    .images {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 10px;
      margin-top: 15px;
    }

    .images img {
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      height: auto;
    }

    a.report-link {
      display: inline-block;
      text-align: center;
      margin: 20px auto;
      font-weight: bold;
      color: var(--primary);
      text-decoration: underline;
    }

    .bigstep {
      background-color: var(--primary);
      border-radius: 20px;
      box-shadow: var(--shadow);
      font-size: 1.2rem;
      padding: 20px;
      margin: 10px 0;
      width: 80%;
      max-width: 350px;
      text-align: center;
    }

    .bigstep-link {
      display: inline-block;   /* para que no ocupe todo el ancho */
      font-weight: bold;
      margin-bottom: 15px;
      border: 3px solid #0047b3;
      color: white;
      text-decoration: none;
      padding: 10px 20px;
      border-radius: 12px;
      transition: background 0.3s ease;
      background: transparent;  /* <- transparente */
    }

    .bigstep-link:hover {
      background: rgba(255,255,255,0.15);
    }

    .subbuttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;  /* centra horizontalmente */
    }

    .subbuttons a {
      background: white;
      color: var(--primary);
      font-size: 1rem;
      padding: 10px;
      border-radius: 12px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;

      width: 90%;       /* todos con mismo ancho */
      max-width: 300px; /* límite para que no sean demasiado grandes */
    }


    .subbuttons a:hover {
      background: var(--accent);
      color: white;
      transform: translateY(-2px);
    }

    .substep-card {
      background: white;
      border: 2px solid var(--primary);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.2s ease;
    }

    .substep-card:hover {
      transform: translateY(-3px);
    }

    .substep-card h3 {
      margin-top: 0;
      color: var(--primary);
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- MENU INICIAL -->
  <h1>Amplicons metagenomics 16S/18S/ITS (Shortreads) offered by SABio</h1>

    <div class="buttons">
    <a href="#fase1">Step 1: Data quality control</a>
    <div class="arrow">↓</div>
    <a href="#fase2">Step 2: Trimming</a>
    <div class="arrow">↓</div>

    <!-- Bloque especial para Step 3 -->
    <div class="bigstep">
      <a href="#fase3" class="bigstep-link">Step 3: QIIME</a>
      <div class="subbuttons">
        <a href="#fase3_1">Step 3.1<br>Data importation and preprocessing</a>
        <a href="#fase3_2">Step 3.2<br>Denoising and Clustering</a>
        <a href="#fase3_3">Step 3.3<br>Taxonomic assignment</a>
        <a href="#fase3_4">Step 3.4<br>Diversity analysis</a>
      </div>
    </div>

    <div class="arrow">↓</div>
    <a href="#fase4">Step 4: Quantification</a>
    <div class="arrow">↓</div>
    <a href="#fase5">Step 5: Differential expression</a>
    <div class="arrow">↓</div>
    <a href="#fase5_1">Step 5.1: PCA loadings biplot</a>
  </div>


  <div class="content" id="fase1">
    <h2>Step 1: Data Quality Control</h2>
    <p>Raw sequencing data (FASTQ files) is assessed for quality using tools like FastQC and MultiQC. This step detects issues such as adapter contamination, low-quality reads, or GC bias before continuing with further analysis.</p>
    <div class="images">
      <img src="fastqc_mal.png" alt="Quality control" style="width: 45%;">
      <img src="fastqc_bien.png" alt="Quality control bad" style="width: 45%;">
    </div>
  </div>

  <div class="content" id="fase2">
    <h2>Step 2: Trimming</h2>
    <p>Trimming removes adapter sequences and low-quality bases from reads. Tools like Trimmomatic or fastp ensure that only high-quality sequences are kept, improving mapping efficiency and accuracy.</p>
    <div class="images">
      <img src="table_trim.png" alt="Trimming" style="width: 55%;">
      <img src="fastp_filtered_reads_plot.png" alt="Lecturas limpias" style="width: 55%;">
    </div>
  </div>

    <!-- Super recuadro del Step 3 -->
  <div class="content" id="fase3">
    <h2>Step 3: QIIME</h2>
    <div class="images">
      <img src="logo.png" alt="Qiime2 logo" style="width: 20%;">
    </div>
    <div class="images">
      <img src="overview.png" alt="Conceptual overview of Qiime2" style="width: 60%;">
    </div>
    <p>QIIME 2 is a powerful, extensible, and decentralized microbiome analysis package with a focus on data and analysis transparency. This package enables researchers to start an analysis with raw DNA sequence data and finish with publication-quality figures and statistical results.</p>

    <div class="substep-card" id="fase3_1">
      <h3>Step 3.1: Data importation and preprocessing</h3>
      <div class="images">
        <img src="preprocessing.png" alt="Preprocessing steps in Qiime2" style="width: 40%;">
      </div>
      <p>In metagenomic workflows, raw sequencing data must undergo a series of preprocessing steps to ensure accuracy and reliability of downstream analyses. These steps include:</p>
      <ul>
        <li><strong>Demultiplexing:</strong>
          Assigning sequencing reads to their corresponding samples based on barcode sequences,thereby enabling the separation of mixed data generated in multiplexed sequencing runs.</li>
        <li><strong>Primer removal:</strong>
          Trimming amplification primer sequences from the reads, as their presence can introduce bias and hinder accurate sequence alignment, taxonomic classification, and diversity estimation.</li>
        <li><strong>Paired-end read joining:</strong>
          Merging forward and reverse reads that overlap into a single contiguous sequence, which improves read quality, extends sequence length, and enhances the resolution of microbial community profiling.</li>
      </ul>
    </div>

    <div class="substep-card" id="fase3_2">
      <h3>Step 3.2: Denoising and Clustering</h3>
      <div class="images">
        <img src="denoise_clustering.png" alt="Denoising and clustering in Qiime2" style="width: 55%;">
      </div>
      <p>In this step, sequencing reads are processed to remove errors, reduce redundancy, and identify biologically meaningful sequence variants.</p>
      <ul>
        <li><strong>Denoising:</strong> 
          Raw sequencing reads are processed to correct errors and remove spurious or low-quality sequences, ensuring high-fidelity data for downstream analysis.</li>
        <li><strong>Dereplication:</strong> 
          Identical sequences are consolidated to reduce redundancy, optimize computational efficiency, and minimize memory usage during subsequent processing steps.</li>
        <li><strong>Clustering:</strong> 
          Similar sequences are grouped into representative sequences, enabling robust identification of biologically relevant variants.</li>
      </ul>
      <p>For this workflow, the <strong>DADA2</strong> algorithm implemented in <strong>QIIME 2</strong> is employed. DADA2 performs comprehensive error correction, filters out chimeric and singleton sequences, merges paired-end reads, and generates dereplicated, high-quality sequence variants.</p>
      <p>The resulting features, obtained after denoising and clustering, are referred to as <strong>amplicon sequence variants (ASVs)</strong>, representing distinct biological sequences at single-nucleotide resolution.</p>
    </div>

    <div class="substep-card" id="fase3_3">
      <h3>Step 3.3: Taxonomic assignment</h3>
      <p>A central objective in many metagenomic studies is the identification of the organisms present within a sample, often at the genus or species level. This information is essential for addressing questions such as the detection of potential pathogens in clinical samples or the characterization of microbial communities in environmental contexts.</p>
      <p>Taxonomic assignment is achieved by comparing query sequences (i.e., features such as ASVs) against curated reference databases containing sequences of known taxonomic composition.</p>
    <div class="images">
      <img src="taxonomy.png" alt="Trimming" style="width: 45%;">
    </div>
    </div>

    <div class="substep-card" id="fase3_4">
      <h3>Step 3.4: Diversity analysis</h3>
      <p>Diversity analyses assess the composition and structure of microbial communities based on phylogenetic relationships between features (e.g., ASVs, OTUs). When sequencing phylogenetic markers such as the 16S rRNA gene, sequences can be aligned to infer evolutionary relatedness, enabling a deeper understanding of community diversity.</p>
      <p>These analyses are typically divided into two categories: <strong>alpha diversity</strong>, which quantifies diversity within individual samples (e.g., richness and evenness), and <strong>beta diversity</strong>, which measures compositional differences between samples or groups of samples. Statistical comparisons of alpha and beta diversity allow investigators to determine whether microbial diversity differs significantly across conditions, environments, or host-associated factors.</p>
    <div class="images">
      <img src="alpha.png" alt="Trimming" style="width: 45%;">
      <img src="beta.png" alt="Lecturas limpias" style="width: 45%;">
    </div>
    </div>
  </div>


  <div class="content" id="fase4">
    <h2>Step 4: Quantification</h2>
    <p>Gene-level quantification determines how many reads align to each gene using tools like featureCounts or HTSeq-count. The result is a count matrix used for comparing gene expression across conditions.</p>
    <div class="images">
      <img src="count_modes.png" alt="Conteo de genes" style="width: 45%;">
      <img src="quant2.jpg" alt="Conteo de genes" style="width: 45%;">
    </div>
  </div>

  <div class="content" id="fase5">
    <h2>Step 5: Differential expression analysis</h2>
    <p>Statistical analysis is performed using tools like DESeq2 to identify genes with significant differences in expression between conditions (e.g., control vs treatment). Outputs include volcano plots, fold changes, and corrected p-values.</p>
    <div class="images">
      <img src="output/Results/deseq2_volcano_Mutant_vs_WT.png" alt="Volcano plot" style="width: auto; height: 400px;">
      <img src="output/DataQuality/deseq2_pca_labels.png" alt="Nueva gráfica" style="width: auto; height: 400px;">
      <img src="output/Results/deseq2_hetmap_Mutant_vs_WT.png" alt="Heatmap de expresión" style="width: auto; height: 400px;">
      <img src="output/Results/deseq2_maplot_Mutant_vs_WT.png" alt="Maplot de expresión" style="width: auto; height: 400px;">
    </div>
    <p style="text-align: center;">
      <a class="report-link" href="output/Results/deseq2_volcano_Mutant_vs_WT.html" target="_blank">
        ➤ View interactive volcano plot report
      </a>
    </p>
  </div>

  <div class="content" id="fase5_1">
    <h2>Step 5.1: Gene contribution to each PC. PCA loadings biplot.</h2>
    <p>
      PCA does not discard any samples or characteristics (genes). Instead, it reduces the overwhelming number of dimensions by constructing principal components (PCs).
      PCs describe variation and account for the varied influences of the original characteristics. Such influences, or loadings, can be traced back from the PCA plot to find out what produces the differences among clusters.
    </p>
    <p>
      A loading plot shows how strongly each gene influences a principal component. Additionally, the angles between the vectors tell how characteristics correlate with one another:
    </p>
    <ul>
      <li>When two vectors are close, forming a small angle, the two variables they represent are positively correlated.</li>
      <li>If they meet each other at 90°, they are not likely to be correlated.</li>
      <li>When they diverge and form a large angle (close to 180°), they are negatively correlated.</li>
    </ul>
    <div class="images">
      <img src="rlog.png" alt="PCA loadings biplot" style="width: auto; height: 400px;">
    </div>
  </div>

</body>
</html>





























