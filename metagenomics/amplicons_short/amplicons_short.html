<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SABio - Metagenomics</title>
  <style>
    :root {
      --primary: #0066ff;
      --accent: #00d1b2;
      --background: #f4f6f9;
      --card-bg: #ffffffee;
      --text-color: #1e1e2f;
      --shadow: 0 12px 30px rgba(0,0,0,0.1);
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #eef2f3, #f5f7fa);
      margin: 0;
      color: var(--text-color);
      scroll-behavior: smooth;
      text-align: justify;
    }

    h1, h2 {
      font-weight: 700;
      text-align: center;
    }

    h1 {
      font-size: 2.8rem;
      margin: 40px 0 20px;
      color: var(--primary);
    }

    h2 {
      color: var(--accent);
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    ul li {
      margin-bottom: 15px; /* Espacio extra entre elementos */
    }

    .buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
    }

    .buttons a {
      background-color: var(--primary);
      color: white;
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
      padding: 12px 24px;
      margin: 5px;
      border-radius: 30px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
      width: 80%;
      max-width: 350px;
      text-align: center;
    }

    .buttons a:hover {
      background-color: #0047b3;
      transform: translateY(-2px);
    }

    .arrow {
      font-size: 20px;
      color: var(--primary);
    }

    .content {
      background: var(--card-bg);
      margin: 40px auto;
      padding: 30px;
      border-radius: 20px;
      max-width: 1000px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      transition: all 0.4s ease;
    }

    .content p {
      line-height: 1.5;
      font-size: 1.05rem;
    }

    .content ul {
      margin-top: 0;
      padding-left: 20px;
      line-height: 1.5;
    }

    .images {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 10px;
      margin-top: 15px;
    }

    .images img {
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      height: auto;
    }

    a.report-link {
      display: inline-block;
      text-align: center;
      margin: 20px auto;
      font-weight: bold;
      color: var(--primary);
      text-decoration: underline;
    }

    .bigstep {
      background-color: var(--primary);
      border-radius: 20px;
      box-shadow: var(--shadow);
      font-size: 1.2rem;
      padding: 20px;
      margin: 10px 0;
      width: 80%;
      max-width: 350px;
      text-align: center;
    }

    .bigstep-link {
      display: inline-block;   /* para que no ocupe todo el ancho */
      font-weight: bold;
      margin-bottom: 15px;
      border: 3px solid #0047b3;
      color: white;
      text-decoration: none;
      padding: 10px 20px;
      border-radius: 12px;
      transition: background 0.3s ease;
      background: transparent;  /* <- transparente */
    }

    .bigstep-link:hover {
      background: rgba(255,255,255,0.15);
    }

    .subbuttons {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;  /* centra horizontalmente */
    }

    .subbuttons a {
      background: white;
      color: var(--primary);
      font-size: 1rem;
      padding: 10px;
      border-radius: 12px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;

      width: 90%;       /* todos con mismo ancho */
      max-width: 300px; /* límite para que no sean demasiado grandes */
    }


    .subbuttons a:hover {
      background: var(--accent);
      color: white;
      transform: translateY(-2px);
    }

    .substep-card {
      background: white;
      border: 2px solid var(--primary);
      border-radius: 15px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.2s ease;
    }

    .substep-card:hover {
      transform: translateY(-3px);
    }

    .substep-card h3 {
      margin-top: 0;
      color: var(--primary);
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- MENU INICIAL -->
  <h1>Amplicons metagenomics 16S/18S/ITS (Shortreads)<br>offered by SABio</h1>

    <div class="buttons">
    <a href="#fase1">Step 1: Data quality control</a>
    <div class="arrow">↓</div>
    <a href="#fase2">Step 2: Trimming</a>
    <div class="arrow">↓</div>

    <!-- Bloque especial para Step 3 -->
    <div class="bigstep">
      <a href="#fase3" class="bigstep-link">Step 3: QIIME</a>
      <div class="subbuttons">
        <a href="#fase3_1">Step 3.1<br>Data importation and preprocessing</a>
        <a href="#fase3_2">Step 3.2<br>Denoising and Clustering</a>
        <a href="#fase3_3">Step 3.3<br>Taxonomic assignment</a>
        <a href="#fase3_4">Step 3.4<br>Diversity analysis</a>
      </div>
    </div>

    <div class="arrow">↓</div>
    <a href="#fase4">Step 4: Quantification</a>
    <div class="arrow">↓</div>
    <a href="#fase5">Step 5: Differential expression</a>
    <div class="arrow">↓</div>
    <a href="#fase5_1">Step 5.1: PCA loadings biplot</a>
  </div>


  <div class="content" id="fase1">
    <h2>Step 1: Data Quality Control</h2>
    <p>Raw sequencing data (FASTQ files) is assessed for quality using tools like <strong>FastQC</strong> (generates detailed quality metrics for individual sequencing files) and <strong>MultiQC</strong> (aggregates FastQC reports across multiple samples, providing a comprehensive overview of the dataset). This step detects issues such as adapter contamination, low-quality reads, or GC bias before continuing with further analysis.</p>
    <p>Performing thorough quality checks ensurse reliable results, reduces biases in analyses and maximizes the value of the data.</p>
    <div class="images">
      <img src="images/fastqc_mal.png" alt="Quality control" style="width: 45%;">
      <img src="images/fastqc_bien.png" alt="Quality control bad" style="width: 45%;">
    </div>
    <p style="text-align: center;"><a href="enlaces/01_fastqc/F3D0_S188_L001_R1_001_fastqc.html" target="_blank">View FastQC Report</a></p>
    <p style="text-align: center;"><a href="enlaces/01_fastqc/multiqc_report.html" target="_blank">View MultiQC Report</a></p>
  </div>

  <div class="content" id="fase2">
    <h2>Step 2: Trimming</h2>
    <p>Trimming is an essential step to ensure that only high-quality reads are used in the downstream analysis. During this process, we remove adapter sequences, low-quality bases, and any technical artifacts introduced during sequencing. This greatly improves the accuracy of subsequent analyses such as alignment, denoising, and taxonomic assignment.</p>
    <p>We use tools such as <strong>Trimmomatic</strong> or <strong>fastp</strong>, which automatically detect adapters, trim poor-quality regions, and filter out unreliable reads.</p>
    <div class="images">
      <img src="images/table_trim.png" alt="Trimming" style="width: 55%;">
      <img src="images/fastp_filtered_reads_plot.png" alt="Lecturas limpias" style="width: 55%;">
    </div>
  </div>

    <!-- Super recuadro del Step 3 -->
  <div class="content" id="fase3">
    <h2>Step 3: QIIME</h2>
    <div class="images">
      <img src="images/logo.png" alt="Qiime2 logo" style="width: 20%;">
    </div>
    <div class="images">
      <img src="images/overview.png" alt="Conceptual overview of Qiime2" style="width: 60%;">
    </div>
    <p>QIIME 2 is a powerful, extensible, and decentralized microbiome analysis package with a focus on data and analysis transparency. This package enables researchers to start an analysis with raw DNA sequence data and finish with publication-quality figures and statistical results.</p>
    <p>In our workflow, QIIME 2 serves as the core tool for transforming high-quality sequencing reads into meaningful 
    microbiome profiles. Using its robust suite of plugins, we can denoise sequences, identify Amplicon Sequence 
    Variants (ASVs), assign taxonomy, evaluate diversity, and visualize microbial patterns across samples.</p>
  
    <h3>Why QIIME 2?</h3>
    <ul>
      <li><strong>Reproducibility:</strong> Every action is logged and provenance is automatically tracked.</li>
      <li><strong>Flexibility:</strong> Supports multiple sequencing strategies and a wide range of analyses.</li>
      <li><strong>Accuracy:</strong> State-of-the-art algorithms such as DADA2 and Deblur deliver high-resolution profiles.</li>
      <li><strong>Visualization:</strong> Provides intuitive and interactive plots for easy interpretation.</li>
    </ul>

    <p>By integrating QIIME 2 into our analysis pipeline, we ensure that researchers receive reliable, well-structured, 
    and biologically meaningful results that support robust scientific conclusions.</p>
    
    <div class="substep-card" id="fase3_1">
      <h3>Step 3.1: Data importation and preprocessing</h3>
      <div class="images">
        <img src="images/preprocessing.png" alt="Preprocessing steps in Qiime2" style="width: 40%;">
      </div>
      <p>In metagenomic workflows, raw sequencing data must be properly prepared and structured. 
      This preprocessing stage ensures that all data entering the workflow is clean, well-organized, and compatible 
      with the analytical tools used later. The main steps involved include:</p>
      <ul>
        <li><strong>Demultiplexing:</strong>
          Assigning sequencing reads to their corresponding samples based on unique barcode sequences.  
          This step separates mixed reads from multiplexed sequencing runs and ensures that each sample is 
          accurately represented in the dataset.</li>
        <li><strong>Primer removal:</strong>
          Eliminating amplification primer sequences from the reads.  
          Removing primers is essential to avoid biases, improve sequence accuracy, and ensure optimal performance 
          during denoising, taxonomic assignment, and diversity calculations.</li>
        <li><strong>Paired-end read joining:</strong>
          Merging overlapping forward and reverse reads into a single high-quality contiguous sequence (when applicable).  
          Joined reads provide better resolution of microbial taxa and increase the accuracy of downstream analyses.</li>
      </ul>
      <p>As part of the preprocessing workflow, we generate an interactive QIIME 2 report that summarizes the quality of the 
      demultiplexed sequences. This visualization includes per-base quality profiles, sequence length distributions, and 
      read counts for each sample.</p>
      <p style="text-align: center;"><a href="enlaces/02_qiime/01_paired_end_sequences.qzv_exported/index.html" target="_blank">View Sequences Report</a></p>
    </div>

    <div class="substep-card" id="fase3_2">
      <h3>Step 3.2: Denoising and Clustering</h3>
      <div class="images">
        <img src="images/denoise_clustering.png" alt="Denoising and clustering in Qiime2" style="width: 55%;">
      </div>
      <p>In this step, sequencing reads are processed to remove errors, reduce redundancy, and identify biologically meaningful sequence variants.</p>
      <ul>
        <li><strong>Denoising:</strong> 
          Raw sequencing reads are processed to correct errors and remove spurious or low-quality sequences, ensuring high-fidelity data for downstream analysis.</li>
        <li><strong>Dereplication:</strong> 
          Identical sequences are consolidated to reduce redundancy, optimize computational efficiency, and minimize memory usage during subsequent processing steps.</li>
        <li><strong>Clustering:</strong> 
          Similar sequences are grouped into representative sequences, enabling robust identification of biologically relevant variants.</li>
      </ul>
      <p>For this workflow, the <strong>DADA2</strong> algorithm implemented in <strong>QIIME 2</strong> is employed. DADA2 performs comprehensive error correction, filters out chimeric and singleton sequences, merges paired-end reads, and generates dereplicated, high-quality sequence variants.</p>
      <p>The resulting features, obtained after denoising and clustering, are referred to as <strong>amplicon sequence variants (ASVs)</strong>, representing distinct biological sequences at single-nucleotide resolution.</p>
    </div>

    <div class="substep-card" id="fase3_3">
      <h3>Step 3.3: Taxonomic assignment</h3>
      <p>A central objective in many metagenomic studies is the identification of the organisms present within a sample, often at the genus or species level. This information is essential for addressing questions such as the detection of potential pathogens in clinical samples or the characterization of microbial communities in environmental contexts.</p>
      <p>Taxonomic assignment is achieved by comparing query sequences (i.e., features such as ASVs) against curated reference databases containing sequences of known taxonomic composition.</p>
    <div class="images">
      <img src="images/taxonomy.png" alt="Taxonomy" style="width: 100%;">
    </div>
    </div>

    <div class="substep-card" id="fase3_4">
      <h3>Step 3.4: Diversity analysis</h3>
      <p>Diversity analyses assess the composition and structure of microbial communities based on phylogenetic relationships between features (e.g., ASVs, OTUs). When sequencing phylogenetic markers such as the 16S rRNA gene, sequences can be aligned to infer evolutionary relatedness, enabling a deeper understanding of community diversity.</p>
      <p>These analyses are typically divided into two categories: <strong>alpha diversity</strong>, which quantifies diversity within individual samples (e.g., richness and evenness), and <strong>beta diversity</strong>, which measures compositional differences between samples or groups of samples. Statistical comparisons of alpha and beta diversity allow investigators to determine whether microbial diversity differs significantly across conditions, environments, or host-associated factors.</p>
    <div class="images">
      <img src="images/alpha.png" alt="Alpha Diversity" style="width: 45%;">
      <img src="images/beta.png" alt="Beta Diversity" style="width: 45%;">
    </div>
    </div>
  </div>


  <div class="content" id="fase4">
    <h2>Step 4: Quantification</h2>
    <p>Gene-level quantification determines how many reads align to each gene using tools like featureCounts or HTSeq-count. The result is a count matrix used for comparing gene expression across conditions.</p>
    <div class="images">
      <img src="images/count_modes.png" alt="Conteo de genes" style="width: 45%;">
      <img src="images/quant2.jpg" alt="Conteo de genes" style="width: 45%;">
    </div>
  </div>

  <div class="content" id="fase5">
    <h2>Step 5: Differential expression analysis</h2>
    <p>Statistical analysis is performed using tools like DESeq2 to identify genes with significant differences in expression between conditions (e.g., control vs treatment). Outputs include volcano plots, fold changes, and corrected p-values.</p>
    <div class="images">
      <img src="output/Results/deseq2_volcano_Mutant_vs_WT.png" alt="Volcano plot" style="width: auto; height: 400px;">
      <img src="output/DataQuality/deseq2_pca_labels.png" alt="Nueva gráfica" style="width: auto; height: 400px;">
      <img src="output/Results/deseq2_hetmap_Mutant_vs_WT.png" alt="Heatmap de expresión" style="width: auto; height: 400px;">
      <img src="output/Results/deseq2_maplot_Mutant_vs_WT.png" alt="Maplot de expresión" style="width: auto; height: 400px;">
    </div>
    <p style="text-align: center;">
      <a class="report-link" href="output/Results/deseq2_volcano_Mutant_vs_WT.html" target="_blank">
        ➤ View interactive volcano plot report
      </a>
    </p>
  </div>

  <div class="content" id="fase5_1">
    <h2>Step 5.1: Gene contribution to each PC. PCA loadings biplot.</h2>
    <p>
      PCA does not discard any samples or characteristics (genes). Instead, it reduces the overwhelming number of dimensions by constructing principal components (PCs).
      PCs describe variation and account for the varied influences of the original characteristics. Such influences, or loadings, can be traced back from the PCA plot to find out what produces the differences among clusters.
    </p>
    <p>
      A loading plot shows how strongly each gene influences a principal component. Additionally, the angles between the vectors tell how characteristics correlate with one another:
    </p>
    <ul>
      <li>When two vectors are close, forming a small angle, the two variables they represent are positively correlated.</li>
      <li>If they meet each other at 90°, they are not likely to be correlated.</li>
      <li>When they diverge and form a large angle (close to 180°), they are negatively correlated.</li>
    </ul>
    <div class="images">
      <img src="rlog.png" alt="PCA loadings biplot" style="width: auto; height: 400px;">
    </div>
  </div>

</body>
</html>

















































