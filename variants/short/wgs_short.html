<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SABio - WGS Short Reads</title>

  <style>
    :root {
      --primary: #0066ff;
      --accent: #00d1b2;
      --background: #f4f6f9;
      --card-bg: #ffffffee;
      --text-color: #1e1e2f;
      --shadow: 0 12px 30px rgba(0,0,0,0.1);
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #eef2f3, #f5f7fa);
      margin: 0;
      color: var(--text-color);
      scroll-behavior: smooth;
      text-align: justify;
    }

    h1, h2 {
      font-weight: 700;
      text-align: center;
    }

    h1 {
      font-size: 2.8rem;
      margin: 40px 0 20px;
      color: var(--primary);
    }

    h2 {
      color: var(--accent);
      font-size: 1.8rem;
      margin-bottom: 10px;
    }

    .buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
    }

    .buttons a {
      background-color: var(--primary);
      color: white;
      text-decoration: none;
      font-weight: 600;
      font-size: 1rem;
      padding: 12px 24px;
      margin: 5px;
      border-radius: 30px;
      transition: all 0.3s ease;
      box-shadow: var(--shadow);
      width: 80%;
      max-width: 350px;
      text-align: center;
    }

    .buttons a:hover {
      background-color: #0047b3;
      transform: translateY(-2px);
    }

    .arrow {
      font-size: 20px;
      color: var(--primary);
    }

    .content {
      background: var(--card-bg);
      margin: 40px auto;
      padding: 30px;
      border-radius: 20px;
      max-width: 1000px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      transition: all 0.4s ease;
    }

    .content p {
      line-height: 1.5;
      font-size: 1.05rem;
    }

    .content ul {
      margin-top: 0;
      padding-left: 20px;
      line-height: 1.5;
    }

    .images {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 10px;
      margin-top: 15px;
    }

    .images img {
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
      height: auto;
    }

    .substep-card {
      background: white;
      border: 2px solid var(--primary);
      border-radius: 30px;
      padding: 20px;
      margin: 20px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.2s ease;
    }

    .substep-card:hover {
      transform: translateY(-3px);
    }

    .substep-card h3 {
      margin-top: 0;
      color: var(--primary);
      text-align: center;
    }

    .section-separator {
      text-align: center;
      font-size: 18px;
      color: #888;
      margin: 15px 0 20px 0;
      letter-spacing: 8px;
    }


  </style>
</head>

<body>

  <h1>Basic WGS (DNAseq) Short Reads<br>offered by SABio</h1>

<div class="buttons">

  <!-- INTRO -->
  <a href="#intro">Introduction to WGS</a>

  <!-- VISUAL SEPARATOR -->
  <div class="section-separator">● ● ●</div>

  <!-- STEPS -->
  <a href="#step1">Step 1: Data Quality Control</a>
  <div class="arrow">↓</div>

  <a href="#step2">Step 2: Trimming</a>
  <div class="arrow">↓</div>

  <a href="#step3">Step 3: Alignment (BWA-MEM)</a>
  <div class="arrow">↓</div>

    <!-- Bloque especial para Step 4 -->
    <div class="bigstep">
      <a href="#step4" class="bigstep-link">Step 4: Variant Analysis Pipeline</a>
      <div class="subbuttons">
        <a href="#fase4_1">Step 4.1<br>Data Preprocessing (Picard)</a>
        <a href="#fase4_2">Step 4.2<br>Variant Calling (GATK)</a>
        <a href="#fase4_3">Step 4.3<br>Variant Filtering (VCFfilter)</a>
      </div>
    </div>
  </div>

  <div class="arrow">↓</div>

  <a href="#step6">Step 5: Variant Annotation (SnpEff)</a>
  <div class="arrow">↓</div>

  <a href="#step7">Step 6: Coverage Plots & IGV Visualization</a>
</div>


  <!-- INTRO -->
<div class="content" id="intro">
  <h2>Whole-Genome Sequencing (WGS) with Short Reads</h2>

  <!-- FLEX CONTAINER -->
  <div style="display: flex; align-items: center; gap: 20px;">

    <!-- TEXT LEFT -->
    <div style="flex: 1;">
      <p>
        <strong>Whole-Genome Sequencing (WGS)</strong> using short-read technology (e.g. Illumina) provides 
        a comprehensive, high-resolution view of the entire DNA content of an organism. Millions of short fragments 
        are sequenced and computationally reconstructed to reveal its genomic structure.
      </p>

      <p>
        When a <strong>reference genome is available</strong>, this process is known as 
        <strong>resecuenciación</strong>: newly sequenced reads are <strong>aligned</strong> against the 
        reference to detect genomic differences.
      </p>

      <p>This allows precise identification of:</p>

      <ul>
        <li><strong>SNPs</strong> – single nucleotide variants</li>
        <li><strong>INDELs &lt;50bp</strong> – small insertions and deletions</li>
        <li><strong>Small structural changes</strong> detectable from mapping patterns</li>
      </ul>
    </div>

    <!-- IMAGE RIGHT -->
    <div style="flex: 0 0 40%; text-align:center;">
      <img src="images/wgs_intro.png" 
           alt="WGS illustration" 
           style="width:100%; max-width:300px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.15);">
    </div>

  </div>
</div>

  </div>

  <!-- STEP 1 -->
  <div class="content" id="step1">
    <h2>Step 1: Data Quality Control</h2>

    <p>
      Raw FASTQ files are evaluated with <strong>FastQC</strong> and summarized using 
      <strong>MultiQC</strong>. We detect GC biases, adapter contamination, duplicated reads, per-base quality 
      and other quality issues to ensure high reliability before alignment.
    </p>

    <div class="images">
      <img src="images/fastqc_bien.png" style="width:45%;">
      <img src="images/fastqc_mal.png" style="width:45%;">
    </div>

    <p style="text-align:center;">
      <a href="enlaces/01_fastqc/ERR023195_1_fastqc.html" target="_blank">View FastQC Report</a>
    </p>
    <p style="text-align:center;">
      <a href="enlaces/01_fastqc/multiqc_report.html" target="_blank">View MultiQC Report</a>
    </p>
  </div>

  <!-- STEP 2 -->
    <div class="content" id="fase2">
    <h2>Step 2: Trimming</h2>
    <p>Trimming is an essential step to ensure that only high-quality reads are used in the downstream analysis. During this process, we remove adapter sequences, low-quality bases, and any technical artifacts introduced during sequencing. This improves alignment accuracy and reduces 
      false positives in variant calling.</p>
    <p>We use tools such as <strong>Trimmomatic</strong> or <strong>fastp</strong>, which automatically detect adapters, trim poor-quality regions, and filter out unreliable reads.</p>
    <div class="images">
      <img src="images/table_trim.png" alt="Trimming" style="width: 55%;">
      <img src="images/fastp_filtered_reads_plot.png" alt="Lecturas limpias" style="width: 55%;">
    </div>
  </div>

  <!-- STEP 3 -->
  <div class="content" id="step3">
    <h2>Step 3: Alignment with BWA-MEM</h2>

    <p>
      High-quality reads are aligned to the reference genome using <strong>BWA-MEM</strong>, one of the most 
      accurate and widely used algorithms for short-read mapping.
    </p>

    <p>
    After the alignment step, <strong>mapping statistics</strong> are generated to evaluate the quality and efficiency 
    of the process using <strong>Samtools</strong>. These include the percentage of properly aligned reads, number of mapped and unmapped reads, 
     duplication rates, insert size distribution, and overall coverage of the reference genome.
    </p>
    
  <p>
  To facilitate interpretation, these alignment metrics are also aggregated and visualized using  <strong>MultiQC</strong>.
  </p>
    <div class="images">
      <img src="images/bam_stats.png" style="width:100%;">
    </div>
  <p style="text-align:center;">
  <a href="enlaces/02_bam/multiqc_report.html" target="_blank">View MultiQC Report</a>
  </p>

  </div>

  <!-- STEP 4 -->
<div class="content" id="step4">
  <h2>Step 4: Variant Analysis Pipeline</h2>
  <p>
    Once the sequencing reads are aligned to the reference genome, the next phase focuses on detecting
    genetic differences. This step involves preparing the aligned data, identifying variants, and filtering
    those variants to ensure high confidence results.
  </p>

<!-- STEP 4.1 -->
<div class="substep-card" id="fase4_1">
  <h3>Step 4.1: Data Preprocessing with Picard</h3>
  <p>
    Before performing variant calling, aligned BAM files must be standardized and cleaned. This is achieved
    using <strong>Picard</strong>, a toolkit developed by the Broad Institute designed to manipulate and optimize
    SAM/BAM/CRAM file formats.
  </p>

  <p>Picard tools allow us to:</p>
  <ul>
    <li>Remove PCR duplicates using <strong>MarkDuplicates</strong></li>
    <li>Fix read groups and metadata inconsistencies</li>
    <li>Sort and index BAM files for efficient processing</li>
  </ul>

  <p>
    These preprocessing steps are crucial because duplicate reads and malformed metadata can introduce
    <strong>false positive variants</strong>. By cleaning the dataset, we ensure that downstream tools such as
    GATK operate on accurate, well-formatted input data.
  </p>
</div>

<!-- STEP 4.2 -->
<div class="substep-card" id="fase4_2">
  <h3>Step 4.2: Variant Calling with GATK</h3>
  <p>
    Variant discovery is performed using <strong>GATK (Genome Analysis Toolkit)</strong>, the gold-standard framework
    for identifying SNPs and INDELs in next-generation sequencing data.
  </p>

  <p>GATK provides:</p>
  <ul>
    <li>Accurate detection of <strong>single nucleotide polymorphisms (SNPs)</strong></li>
    <li>Identification of <strong>insertions and deletions (INDELs)</strong></li>
    <li>A probabilistic model (<strong>HaplotypeCaller</strong>) designed to distinguish true mutations from sequencing noise</li>
  </ul>

  <p>
    GATK is widely adopted by genomic research consortia due to its reproducibility, scalability, and
    sophisticated error-modeling algorithms, making it ideal for high-throughput DNA variant analysis.
  </p>
</div>

<!-- STEP 4.3 -->
<div class="substep-card" id="fase4_3">
  <h3>Step 4.3: Variant Filtering</h3>
  <p>
    The raw variant file generated by GATK may still contain sequencing artifacts. To ensure reliability,
    we apply filtering criteria to retain only variants passing specific thresholds, such as read depth,
    genotype quality, and allele frequency.
  </p>

  <p>
    This step reduces false positives and results in a high-confidence VCF file suitable for downstream
    interpretation and biological analysis.
  </p>
</div>
</div>

<!-- STEP 5 -->
<div class="content" id="step5">
  <h2>Step 5: Variant Annotation with SnpEff</h2>
  <p>
    Once high-confidence variants are obtained, they must be biologically interpreted. This is done using
    <strong>SnpEff</strong>, a specialized annotation tool that predicts the functional impact of each variant
    based on genomic context.
  </p>

  <p>SnpEff allows us to:</p>
  <ul>
    <li>Determine whether a variant lies in a gene, exon, intron, UTR, or intergenic region</li>
    <li>Infer the consequence of nucleotide changes (missense, synonymous, frameshift, stop gained, etc.)</li>
    <li>Prioritize variants with potential phenotypic relevance</li>
  </ul>

  <p>
    At the end of this step, the VCF file becomes a biologically meaningful dataset, enabling hypotheses
    about gene function, phenotype association, and evolutionary relevance.
  </p>
</div>

<!-- STEP 6 -->
<div class="content" id="step6">
  <h2>Step 6: Coverage Analysis & IGV Visualization</h2>
  <p>
    Sequencing coverage provides insight into how uniformly the genome has been sequenced. Insufficient or
    uneven coverage can lead to missing variants or false positives.
  </p>

  <p>
    We generate coverage plots to assess read depth across the genome and verify the quality of sequencing.
    Finally, we visualize both coverage and annotated variants using <strong>IGV (Integrative Genomics Viewer)</strong>,
    an interactive genome browser that allows manual inspection of genomic loci, read alignments, and variant
    positions.
  </p>

  <p>
    This visual confirmation step is essential for validating complex variants and ensuring that the computational
    predictions align with the raw sequencing evidence.
  </p>
</div>


</body>
</html>
















